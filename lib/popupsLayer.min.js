"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done);n=true){r.push(l.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){if(t)_defineProperties(e.prototype,t);if(r)_defineProperties(e,r);return e}var PopupsLayer=function(){function l(e){var t=e.layer,r=e.title,n=e.content,a=e.after,i=a===void 0?null:a;_classCallCheck(this,l);var o=function(){function c(e){var t=e.layer,r=e.title,n=e.content,a=e.after,i=a===void 0?null:a;_classCallCheck(this,c);var o={layer:{position:"CENTER",style:{background:"#ffffff",borderRadius:"5px",maxWidth:"none"}},title:{enable:true,draggable:true,btnGroup:{enable:true,close:true},style:{color:"#666666",fontSize:"14px",borderBottom:".4px solid rgba(75, 97, 124, 0.53)"}},content:{style:{color:"#666666",fontSize:"14px"}}};this.config=c.objectDeepCopy(o,{layer:t,title:r,content:n});this.popupsLayer=document.createElement("div");this.popupsLayer.classList.add("popups-layer");this.createLayer();if(this.config.title.enable)this.createTitle();this.createContent();if(document.querySelectorAll(".popups-layer").length){var l=document.querySelectorAll(".popups-layer");var s=l[l.length-1].nextElementSibling;document.body.insertBefore(this.popupsLayer,s)}else{document.body.insertBefore(this.popupsLayer,document.body.firstElementChild)}if(i instanceof Function)i()}_createClass(c,[{key:"createLayer",value:function e(){var t=this.config.layer;var r={LEFT:"left: 0",RIGHT:"right: 0",BOTTOM:"bottom: 0",CENTER:"top: 50%; left: 50%; transform: translate(-50%, -50%);"};this.layer=document.createElement("div");this.layer.classList.add("popups-layer-box");this.layer.setAttribute("style","".concat(r[t.position]));var n=Object.entries(t.style);for(var a=0;a<n.length;a++){var i=_slicedToArray(n[a],2),o=i[0],l=i[1];this.layer.style[o]=l}this.popupsLayer.appendChild(this.layer)}},{key:"createTitle",value:function e(){var t=this.config.title;var r=document.createElement("div");r.classList.add("popups-layer-title");var n=Object.entries(t.style);for(var a=0;a<n.length;a++){var i=_slicedToArray(n[a],2),o=i[0],l=i[1];r.style[o]=l}if(t.hasOwnProperty("text"))r.innerText=t.text;if(t.hasOwnProperty("template")){r.innerHTML+=t.template}if(t.btnGroup.enable){var s=this;var c=document.createElement("div");c.classList.add("popups-layer-btn-group");var u={close:function e(){var t=document.createElement("i");t.classList.add("iconfont");t.classList.add("icon-guanbi");c.appendChild(t);t.addEventListener("click",function(){s.close()})}};var p=Object.entries(t.btnGroup);for(var d=0;d<p.length;d++){var f=_slicedToArray(p[d],2),o=f[0],l=f[1];if(Object.is(o,"enable"))continue;if(l){u[o]()}}r.appendChild(c)}var y=Object.entries(t.style);for(var v=0;v<y.length;v++){var h=_slicedToArray(y[v],2),o=h[0],l=h[1];if(l){var m=document.createElement("i");m.classList.add(o)}}if(t.draggable)this.dragLayer(r);this.layer.appendChild(r)}},{key:"createContent",value:function e(){var t=this.config.content;var r=document.createElement("div");r.classList.add("popups-layer-content");var n=Object.entries(t.style);for(var a=0;a<n.length;a++){var i=_slicedToArray(n[a],2),o=i[0],l=i[1];r.style[o]=l}var s=document.createElement("div");s.classList.add("popups-layer-text");if(t.hasOwnProperty("icon")){var c=document.createElement("img");c.src=t.icon.src;c.style.cssFloat=t.icon.position.toLowerCase();s.appendChild(c)}if(t.hasOwnProperty("text")){var u=document.createElement("p");u.innerText=t.text;s.appendChild(u)}if(t.hasOwnProperty("template")){var p=s.innerHTML;s.innerHTML=p+t.template}r.appendChild(s);if(t.hasOwnProperty("btnGroup")){var d=document.createElement("div");d.classList.add("btn-box");var f=Object.entries(t.btnGroup);for(var y=0;y<f.length;y++){var v=_slicedToArray(f[y],2),o=v[0],l=v[1];var h=document.createElement("button");h.classList.add("btn");h.setAttribute("id",o);if(l.text){h.innerText=l.text}if(l.fn){h.addEventListener("click",l.fn)}if(l.theme){h.classList.add(l.theme)}d.appendChild(h)}r.appendChild(d)}this.layer.appendChild(r)}},{key:"dragLayer",value:function e(t){var r=this;var n=false;t.style.cursor="all-scroll";t.addEventListener("mousedown",function(e){e.preventDefault();n=true});this.popupsLayer.addEventListener("mouseup",function(e){e.preventDefault();n=false});this.popupsLayer.addEventListener("mousemove",function(e){e.preventDefault();if(n){r.layer.style.left="".concat(r.layer.offsetLeft+e.movementX,"px");r.layer.style.top="".concat(r.layer.offsetTop+e.movementY,"px")}})}},{key:"close",value:function e(){document.body.removeChild(this.popupsLayer)}}],[{key:"objectDeepCopy",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=Object.keys(t);if(n.length){for(var a=0;a<n.length;a++){if(!r.hasOwnProperty(n[a]))r[n[a]]={};if(Object.prototype.toString.call(t[n[a]])==="[object Object]")this.objectDeepCopy(t[n[a]],r[n[a]]);if(r[n[a]]===""||JSON.stringify(r[n[a]])!=="{}")continue;r[n[a]]=t[n[a]]}}return r}}]);return c}();this._ui=new o({layer:t,title:r,content:n,after:i})}_createClass(l,[{key:"close",value:function e(){this._ui.close()}},{key:"destroy",value:function e(){this._ui=null}}]);return l}();